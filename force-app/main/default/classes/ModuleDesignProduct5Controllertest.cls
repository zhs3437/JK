@isTest
public class ModuleDesignProduct5Controllertest {
     static testMethod void myUnitTest() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM445M-72HLM-V';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
         opp.Region__c ='ROA';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
        ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
    
     static testMethod void myUnitTest2() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM330M-60H';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          opp.Destination_Country__c ='Australia';
         opp.Region__c ='ROA';
         opp.Branch__c='test';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
        insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
          ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
     static testMethod void myUnitTest3() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM445M-60HL4-V';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='North Asia';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
          ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
static testMethod void myUnitTest4() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM370M-60HLM-V';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='MENA';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
        ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
static testMethod void myUnitTest5() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM310M-60HBL';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='North America';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
     ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
    static testMethod void myUnitTest6() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM445M-72HLM-BDVP';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='CN';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
         ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
    static testMethod void myUnitTest8() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKMXXXM-7RL3-V';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='South Asia';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
         ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
  static testMethod void myUnitTest9() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='MM445-60HLD-MBV';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='EU(Union)';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
         ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }
  static testMethod void myUnitTest7() {
      Profile p = [select id from profile where name='系统管理员' or name='System Administrator'];
        User u = TestHelper.createUser(p.Id, 'u1@qq.com', true);
       
          Product2 prod = new Product2();
        prod.Maximum_Power_at_STC_Pmax__c = 300;
        prod.name ='JKM465M-7RL3-V';
        prod.IsActive = true;
         insert prod;
         PricebookEntry entry = TestHelper.createPriceBookEntry(prod.Id);
        Account acc = TestHelper.createAccount();
         Opportunity opp = TestHelper.createOpportunity(acc.Id);
          //opp.Destination_Country__c ='Australia';
         opp.Region__c ='Latin America&Italy';
         update opp;
        Contract con = TestHelper.createContract(acc.Id,false);
        con.Contract_NO__c = '2016101000';
        insert con;
        OpportunityLineItem pd1	= new OpportunityLineItem();        
      		pd1.Opportunity=opp;
         pd1.Product2Id =prod.Id;
        pd1.Grade__c 						= 'A-Grade A';
        pd1.Special_required__c 			= 'J4-Black Silicon Module';
        pd1.Bus_bars_of_cell__c 			= '4-4BB';
        //pd1.UnitPrice						= 1;   
        pd1.OpportunityId =opp.id;
            pd1.Quantity =40;
            pd1.Guaranteed_Delivery_Date__c =Date.today();
        	pd1.TotalPrice=100;
        pd1.PricebookEntryId=entry.id;
        insert pd1;
       
        
        List<OpportunityLineItem> oiLst = new List<OpportunityLineItem>();
        oiLst.add(pd1);
        Component_Task_Book__c ctb2 = TestHelper.createComponentTaskBook(Opp,false);
		    insert ctb2;
          ModuleDesignParam__c mdp = new ModuleDesignParam__c();
         mdp.OppId__c ='test1';
       mdp.Module_Design_Product_Name__c ='test2'; 
       mdp.CellType1__c  ='test3'; 
       mdp.Module_Series1__c  ='test4'; 
       mdp.Module_Design_Product_Cell_Quantity__c ='test5'; 
       mdp.ProductCertificate__c ='test6';
       mdp.Additional_Certificate__c ='test7'; 
       mdp.Mandatory_certification__c ='test8'; 
       mdp.Power_Tolerance__c ='test9'; 
       mdp.System_Voltage__c ='test10'; 
       mdp.Additional_power__c ='test11'; 
       mdp.Module_Design_Warranty__c ='test12';
       mdp.Package__c ='test13';
       mdp.Junction_Box_Type__c ='test14';
       mdp.Junction_Box_Cable_Length__c ='test15';
       mdp.Junction_Box_Connector__c ='test16';
       mdp.Rear_cover__c ='test17';
       mdp.Frame_B_side_Height__c ='test18';
       mdp.Frame_Type__c ='test19';
       mdp.EVA__c ='test20';
       mdp.LRF__c ='test21';
       mdp.Project_Type__c ='test22';
       mdp.String_Ribbon__c ='test23';
       mdp.Cell_Color__c ='test24';
       mdp.Current_Sorting__c ='test25';
       mdp.Current_Sorting_Style__c ='test26';
       mdp.Color_Sorting_style__c ='test27';
       mdp.Production_supervision_by_Client_or_3rd__c ='test28';
       mdp.Pre_shipping_Inspection_factory__c ='test29';
       mdp.Special_Approval_for_order_production__c ='test30';
       mdp.Nameplate__c ='test31';
       mdp.Shipping_Mark__c ='test32';
       mdp.Barcode_encoding_principle__c ='test33';
       mdp.Transportation_style__c ='test34';
       mdp.Lab_tests__c ='test35';
       mdp.Regional_customs_clearance_request__c ='test36';
       mdp.Front_Glass__c ='test37';
       mdp.Mandatory_certification__c ='test38';
        insert mdp;
        ApexPages.currentPage().getParameters().put('opportunityId',opp.Id);
         ApexPages.currentPage().getParameters().put('p1',pd1.Id); 
        ApexPages.StandardSetController ctrl = new ApexPages.StandardSetController(Database.getQueryLocator( [SELECT Id,Name FROM Component_Task_Book__c]));
        ModuleDesignProduct5Controller mdpc = new ModuleDesignProduct5Controller(ctrl);
      
        mdpc.goto();
     }


}