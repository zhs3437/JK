@isTest
public class RC_CommissionApplicationTest {    
    public static testMethod void submitTest(){
        Account a = new Account();
        a.VAT_NO__c = 'ABC';
        a.Name = 'Jinko SOlar Company';
        a.Phone = '13615827359';
        a.Website = 'www.jinko.com';
        Id RecordTypeId = Schema.SObjectType.Account.getRecordTypeInfosByDeveloperName().get('China_Account').getRecordTypeId();
        System.debug('RecordTypeId----------->'+RecordTypeId);
        a.RecordTypeId = RecordTypeId;
        a.Bank_Account__c = '中国银行';
        a.Bank_City__c = '上海';
        a.Bank_Code__c = '12345';
        a.Bank_Country__c = '中国';
        //a.Bank_Name__c = '虹口支行';
        a.Bank_Region__c = 'CN';
        a.Bank_Street__c = '上海市虹口区密云路2333号';    	
        a.BillingCity = '上海市';
        a.BillingCountry = '中国';
        a.BillingState = 'Test';
        a.BillingStreet = 'Test';
        Insert a;
        Contact cc = new Contact();         
        cc.Phone = '13615827359';
        cc.AccountId = a.id;
        cc.FirstName = 'Guang';
        cc.LastName = 'AWEJ';         
        insert cc;    	    
        leanx__pm_Project__c opp = new leanx__pm_Project__c();
        opp.Expect_Price_And_Comments__c = '12345';       
        opp.Name = '12345'; 
        opp.CurrencyIsoCode = 'CNY';
        opp.leanx__Account__c = a.id;
        opp.Trade_Term__c = 'CIF';                  
        opp.Destination_Country__c = 'China';
        opp.Destination_Region__c = 'CN';       
        opp.Delivery_Point__c = '手提';
        opp.Seller__c = 'ZHEJIANG JINKO SOLAR CO.,LTD';
        opp.Warranty_Insurance__c = 'AR';     
        opp.Commission__c = 0.1;
        opp.Commission_Type__c = 'Per/W';              
        Insert opp;
        ApexPages.currentPage().getParameters().put('id',opp.Id);  
        ApexPages.currentPage().getParameters().put('num','1');   
        ApexPages.currentPage().getParameters().put('conid','no');   
        RC_CommissionApplication op =new RC_CommissionApplication();
       
        //第二个页面测试页面
        //CommissionApplicationVFCtrl cavf=new CommissionApplicationVFCtrl(std);
        op.blob1 =Blob.valueOf('this is Attachment body');
        op.blob1name ='this is Attachment body';
        op.blob14 =Blob.valueOf('this is Attachment body');
        op.blob14name ='this is Attachment body';
        op.blob15 =Blob.valueOf('this is Attachment body');
        op.blob15name ='this is Attachment body';
        op.blob16 =Blob.valueOf('this is Attachment body');
        op.blob16name ='this is Attachment body';
        op.blob17 =Blob.valueOf('this is Attachment body');
        op.blob17name ='this is Attachment body';
        op.blob23 =Blob.valueOf('this is Attachment body');
        op.blob23name ='this is Attachment body';
        op.blob24 =Blob.valueOf('this is Attachment body');
        op.blob24name ='this is Attachment body';
        op.blob25 =Blob.valueOf('this is Attachment body');
        op.blob25name ='this is Attachment body';
        op.blob26 =Blob.valueOf('this is Attachment body');
        op.blob26name ='this is Attachment body';
        op.blob27 =Blob.valueOf('this is Attachment body');
        op.blob27name ='this is Attachment body';
        op.blob29 =Blob.valueOf('this is Attachment body');
        op.blob29name ='this is Attachment body';
        op.blob211 =Blob.valueOf('this is Attachment body');
        op.blob211name ='this is Attachment body';
        op.blob213 =Blob.valueOf('this is Attachment body');
        op.blob213name ='this is Attachment body';
        op.blob212 =Blob.valueOf('this is Attachment body');
        op.blob212name ='this is Attachment body';
        op.blob215 =Blob.valueOf('this is Attachment body');
        op.blob215name ='this is Attachment body';
        op.blob219 =Blob.valueOf('this is Attachment body');
        op.blob219name ='this is Attachment body';        
        op.Addsobj();                
        //CommissionApplicationVFCtrl cavf1=new CommissionApplicationVFCtrl(std);
       /* cavf1.blob1 =Blob.valueOf('this is Attachment body');
        cavf1.blob1name ='this is Attachment body';
        cavf1.blob14 =Blob.valueOf('this is Attachment body');
        cavf1.blob14name ='this is Attachment body';
        cavf1.blob15 =Blob.valueOf('this is Attachment body');
        cavf1.blob15name ='this is Attachment body';
        cavf1.blob16 =Blob.valueOf('this is Attachment body');
        cavf1.blob16name ='this is Attachment body';
        cavf1.blob17 =Blob.valueOf('this is Attachment body');
        cavf1.blob17name ='this is Attachment body';
        cavf1.blob23 =Blob.valueOf('this is Attachment body');
        cavf1.blob23name ='this is Attachment body';
        cavf1.blob24 =Blob.valueOf('this is Attachment body');
        cavf1.blob24name ='this is Attachment body';
        cavf1.blob25 =Blob.valueOf('this is Attachment body');
        cavf1.blob25name ='this is Attachment body';
        cavf1.blob26 =Blob.valueOf('this is Attachment body');
        cavf1.blob26name ='this is Attachment body';
        cavf1.blob27 =Blob.valueOf('this is Attachment body');
        cavf1.blob27name ='this is Attachment body';
        cavf1.blob29 =Blob.valueOf('this is Attachment body');
        cavf1.blob29name ='this is Attachment body';
        cavf1.blob211 =Blob.valueOf('this is Attachment body');
        cavf1.blob211name ='this is Attachment body';
        cavf1.blob213 =Blob.valueOf('this is Attachment body');
        cavf1.blob213name ='this is Attachment body';
        cavf1.blob212 =Blob.valueOf('this is Attachment body');
        cavf1.blob212name ='this is Attachment body';
        cavf1.blob215 =Blob.valueOf('this is Attachment body');
        cavf1.blob215name ='this is Attachment body';
        cavf1.blob219 =Blob.valueOf('this is Attachment body');
        cavf1.blob219name ='this is Attachment body';        
        cavf1.Addsobj();
        test.stopTest();*/
        //对象内的页面
        String oppid=opp.Id;
        List<Commission_Application2__c> calst =Database.query(UtilClass.MakeSelectSql(Schema.SObjectType.Commission_Application2__c) + ' ' +
                                                               'Where Project__c =: oppid');
        User user = new User(Username='u'+System.now().getTime()+'@163.com',
                             Email='jason_trixpro@163.com',
                             FirstName='jason',
                             LastName='jia',
                             Alias='UJia',
                             ProfileId=UserInfo.getProfileId());               
        user.TimeZoneSidKey='Asia/Shanghai';
        user.LocaleSidKey='en_US';
        user.EmailEncodingKey='ISO-8859-1';
        user.LanguageLocaleKey='en_US';
        user.Region__c ='ROA';
        insert user;
        
        Opportunity testObj = TestHelper.createOpportunity(a.Id);       
        Messaging.InboundEmail email = new Messaging.InboundEmail();
        Messaging.InboundEnvelope env = new Messaging.InboundEnvelope();        
        RC_CommissionApproveEmailService testPriceApprove = new  RC_CommissionApproveEmailService();        
        User userTest = [SELECT ID,EMAIL,Name from User WHERE Name =:'Anita Li'];
        env.fromAddress = userTest.Email;
        email.fromAddress = userTest.Email;
        email.subject = '[#RVID:'+ calst[0].id +'#]Please review this opportunity';
        email.plainTextBody = ' reject \nTest002';
        testPriceApprove.handleInboundEmail( email , env );  		
        email.plainTextBody = ' yes \nTest001';
        testPriceApprove.handleInboundEmail( email , env );  
        //Opportunity testOpp = [SELECT ID, Price_Approval_Status__c From Opportunity Where ID=:testObj.Id];
        
    }
      public static testMethod void submitTest2(){
        Account a = new Account();
        a.VAT_NO__c = 'ABC';
        a.Name = 'Jinko SOlar Company';
        a.Phone = '13615827359';
        a.Website = 'www.jinko.com';
        Id RecordTypeId = Schema.SObjectType.Account.getRecordTypeInfosByDeveloperName().get('China_Account').getRecordTypeId();
        System.debug('RecordTypeId----------->'+RecordTypeId);
        a.RecordTypeId = RecordTypeId;
        a.Bank_Account__c = '中国银行';
        a.Bank_City__c = '上海';
        a.Bank_Code__c = '12345';
        a.Bank_Country__c = '中国';
        //a.Bank_Name__c = '虹口支行';
        a.Bank_Region__c = 'CN';
        a.Bank_Street__c = '上海市虹口区密云路2333号';    	
        a.BillingCity = '上海市';
        a.BillingCountry = '中国';
        a.BillingState = 'Test';
        a.BillingStreet = 'Test';
        Insert a;
        Contact cc = new Contact();         
        cc.Phone = '13615827359';
        cc.AccountId = a.id;
        cc.FirstName = 'Guang';
        cc.LastName = 'AWEJ';         
        insert cc;    	    
        leanx__pm_Project__c opp = new leanx__pm_Project__c();
        opp.Expect_Price_And_Comments__c = '12345';       
        opp.Name = '12345'; 
        opp.CurrencyIsoCode = 'CNY';
        opp.leanx__Account__c = a.id;
        opp.Trade_Term__c = 'CIF';                  
        opp.Destination_Country__c = 'China';
        opp.Destination_Region__c = 'CN';       
        opp.Delivery_Point__c = '手提';
        opp.Seller__c = 'ZHEJIANG JINKO SOLAR CO.,LTD';
        opp.Warranty_Insurance__c = 'AR';     
        opp.Commission__c = 0.1;
        opp.Commission_Type__c = 'Per/W';              
        Insert opp;
          
        ApexPages.currentPage().getParameters().put('id',opp.Id);  
        ApexPages.currentPage().getParameters().put('num','2');   
        ApexPages.currentPage().getParameters().put('conid','no');   
        RC_CommissionApplication op =new RC_CommissionApplication();
          Commission_Application2__c aaa = new Commission_Application2__c();
          aaa.Project__c =opp.id;
          aaa.Address_of_Payee__c='123';
          aaa.Name = 'OPPV1';
          aaa.Office_address_of_Buyer__c='123';
          aaa.Contact_person_of_Buyer__c='123';
          aaa.Position_of_contact_person_in_the_Buyer__c = '123';
          aaa.Shareholder_of_Buyer__c = '123';
          aaa.Contract_Unit_price__c = 1.4;
          aaa.Project_Location_Coutry__c ='13';
          aaa.Project_location_Address__c = '123';
          aaa.Role_of_Buyer_in_the_project__c = 'EPC';
          aaa.Nature_of_project__c = 'Utility';
          aaa.Commission_Per_watt__c = 0.01;
          aaa.Commission_Payee_Company__c = '123';
          aaa.Name_of_contact_person_of_Payee__c = '123';
          aaa.Position_of_contact_person_in_the_Payee__c='123';
          aaa.Mobile_Number_of_contact_person_of_Payee__c ='123';
          aaa.The_photocopy_of_ID_card__c = '21312412231231321';
          aaa.X7_1_TEXT__c = '123';
          aaa.X7_2_TEXT__c = '123';
          aaa.X7_3__c ='123';
          aaa.X7_4_TEXT__c = '132';
          aaa.Shareholder_of_Payee__c = '123';
          aaa.The_actual_controller_of_Payee__c = '123';
          aaa.The_photocopy_of_ID_card_of_shareholders__c = '123';
          aaa.The_photocopy_of_ID_card_of_actual_contr__c = '123';
          aaa.Number_of_employees_of_Payee__c = '123';
          aaa.X15_1_TEXT__c = '123';
          aaa.X15_2_TEXT__c = '123';
          aaa.X15_3_TEXT__c = '123';
          aaa.Role_of_the_Payee_in_the_Project__c = 'EPC';
          aaa.Work_done_by_the_Payee_for_Jinko__c = '123';
          aaa.X18_1_TEXT__c  = '123';
          aaa.X18_2_TEXT__c='123';
          aaa.X18_3_TEXT__c='123';
          aaa.X18_4_TEXT__c='123';
          aaa.X18_5_TEXT__c ='123';
          aaa.X18_6_TEXT__c = '123';
          aaa.X18_7_TEXT__c = '123';
          aaa.Brief_Record_of_the_Discussion__c= '123';          
          insert aaa;
          
       op.calst.add(aaa);
          op.caold =aaa;
          
          
          Commission_Application2__c aaa2 = new Commission_Application2__c();
          aaa2.Project__c =opp.id;
          aaa2.Address_of_Payee__c='123';
          aaa2.Name = 'OPPV1';
          aaa2.Office_address_of_Buyer__c='123';
          aaa2.Contact_person_of_Buyer__c='123';
          aaa2.Position_of_contact_person_in_the_Buyer__c = '123';
          aaa2.Shareholder_of_Buyer__c = '123';
          aaa2.Contract_Unit_price__c = 1.4;
          aaa2.Project_Location_Coutry__c ='13';
          aaa2.Project_location_Address__c = '123';
          aaa2.Role_of_Buyer_in_the_project__c = 'EPC';
          aaa2.Nature_of_project__c = 'Utility';
          aaa2.Commission_Per_watt__c = 0.01;
          aaa2.Commission_Payee_Company__c = '123';
          aaa2.Name_of_contact_person_of_Payee__c = '123';
          aaa2.Position_of_contact_person_in_the_Payee__c='123';
          aaa2.Mobile_Number_of_contact_person_of_Payee__c ='123';
          aaa2.The_photocopy_of_ID_card__c = '21312412231231321';
          aaa2.X7_1_TEXT__c = '123';
          aaa2.X7_2_TEXT__c = '123';
          aaa2.X7_3__c ='123';
          aaa2.X7_4_TEXT__c = '132';
          aaa2.Shareholder_of_Payee__c = '123';
          aaa2.The_actual_controller_of_Payee__c = '123';
          aaa2.The_photocopy_of_ID_card_of_shareholders__c = '123';
          aaa2.The_photocopy_of_ID_card_of_actual_contr__c = '123';
          aaa2.Number_of_employees_of_Payee__c = '123';
          aaa2.X15_1_TEXT__c = '123';
          aaa2.X15_2_TEXT__c = '123';
          aaa2.X15_3_TEXT__c = '123';
          aaa2.Role_of_the_Payee_in_the_Project__c = 'EPC';
          aaa2.Work_done_by_the_Payee_for_Jinko__c = '123';
          aaa2.X18_1_TEXT__c  = '123';
          aaa2.X18_2_TEXT__c='123';
          aaa2.X18_3_TEXT__c='123';
          aaa2.X18_4_TEXT__c='123';
          aaa2.X18_5_TEXT__c ='123';
          aaa2.X18_6_TEXT__c = '123';
          aaa2.X18_7_TEXT__c = '123';
          aaa2.Brief_Record_of_the_Discussion__c= '122';          
          insert aaa2;
          op.ca = aaa2;
        //第二个页面测试页面
        //CommissionApplicationVFCtrl cavf=new CommissionApplicationVFCtrl(std);
        op.blob1 =Blob.valueOf('this is Attachment body');
        op.blob1name ='this is Attachment body';
        op.blob14 =Blob.valueOf('this is Attachment body');
        op.blob14name ='this is Attachment body';
        op.blob15 =Blob.valueOf('this is Attachment body');
        op.blob15name ='this is Attachment body';
        op.blob16 =Blob.valueOf('this is Attachment body');
        op.blob16name ='this is Attachment body';
        op.blob17 =Blob.valueOf('this is Attachment body');
        op.blob17name ='this is Attachment body';
        op.blob23 =Blob.valueOf('this is Attachment body');
        op.blob23name ='this is Attachment body';
        op.blob24 =Blob.valueOf('this is Attachment body');
        op.blob24name ='this is Attachment body';
        op.blob25 =Blob.valueOf('this is Attachment body');
        op.blob25name ='this is Attachment body';
        op.blob26 =Blob.valueOf('this is Attachment body');
        op.blob26name ='this is Attachment body';
        op.blob27 =Blob.valueOf('this is Attachment body');
        op.blob27name ='this is Attachment body';
        op.blob29 =Blob.valueOf('this is Attachment body');
        op.blob29name ='this is Attachment body';
        op.blob211 =Blob.valueOf('this is Attachment body');
        op.blob211name ='this is Attachment body';
        op.blob213 =Blob.valueOf('this is Attachment body');
        op.blob213name ='this is Attachment body';
        op.blob212 =Blob.valueOf('this is Attachment body');
        op.blob212name ='this is Attachment body';
        op.blob215 =Blob.valueOf('this is Attachment body');
        op.blob215name ='this is Attachment body';
        op.blob219 =Blob.valueOf('this is Attachment body');
        op.blob219name ='this is Attachment body';        
        op.Addsobj();                
        //CommissionApplicationVFCtrl cavf1=new CommissionApplicationVFCtrl(std);
       /* cavf1.blob1 =Blob.valueOf('this is Attachment body');
        cavf1.blob1name ='this is Attachment body';
        cavf1.blob14 =Blob.valueOf('this is Attachment body');
        cavf1.blob14name ='this is Attachment body';
        cavf1.blob15 =Blob.valueOf('this is Attachment body');
        cavf1.blob15name ='this is Attachment body';
        cavf1.blob16 =Blob.valueOf('this is Attachment body');
        cavf1.blob16name ='this is Attachment body';
        cavf1.blob17 =Blob.valueOf('this is Attachment body');
        cavf1.blob17name ='this is Attachment body';
        cavf1.blob23 =Blob.valueOf('this is Attachment body');
        cavf1.blob23name ='this is Attachment body';
        cavf1.blob24 =Blob.valueOf('this is Attachment body');
        cavf1.blob24name ='this is Attachment body';
        cavf1.blob25 =Blob.valueOf('this is Attachment body');
        cavf1.blob25name ='this is Attachment body';
        cavf1.blob26 =Blob.valueOf('this is Attachment body');
        cavf1.blob26name ='this is Attachment body';
        cavf1.blob27 =Blob.valueOf('this is Attachment body');
        cavf1.blob27name ='this is Attachment body';
        cavf1.blob29 =Blob.valueOf('this is Attachment body');
        cavf1.blob29name ='this is Attachment body';
        cavf1.blob211 =Blob.valueOf('this is Attachment body');
        cavf1.blob211name ='this is Attachment body';
        cavf1.blob213 =Blob.valueOf('this is Attachment body');
        cavf1.blob213name ='this is Attachment body';
        cavf1.blob212 =Blob.valueOf('this is Attachment body');
        cavf1.blob212name ='this is Attachment body';
        cavf1.blob215 =Blob.valueOf('this is Attachment body');
        cavf1.blob215name ='this is Attachment body';
        cavf1.blob219 =Blob.valueOf('this is Attachment body');
        cavf1.blob219name ='this is Attachment body';        
        cavf1.Addsobj();
        test.stopTest();*/
        //对象内的页面
        String oppid=opp.Id;
        List<Commission_Application2__c> calst =Database.query(UtilClass.MakeSelectSql(Schema.SObjectType.Commission_Application2__c) + ' ' +
                                                               'Where Project__c =: oppid');
        User user = new User(Username='u'+System.now().getTime()+'@163.com',
                             Email='jason_trixpro@163.com',
                             FirstName='jason',
                             LastName='jia',
                             Alias='UJia',
                             ProfileId=UserInfo.getProfileId());               
        user.TimeZoneSidKey='Asia/Shanghai';
        user.LocaleSidKey='en_US';
        user.EmailEncodingKey='ISO-8859-1';
        user.LanguageLocaleKey='en_US';
        user.Region__c ='ROA';
        insert user;
        
        Opportunity testObj = TestHelper.createOpportunity(a.Id);       
        Messaging.InboundEmail email = new Messaging.InboundEmail();
        Messaging.InboundEnvelope env = new Messaging.InboundEnvelope();        
        RC_CommissionApproveEmailService testPriceApprove = new  RC_CommissionApproveEmailService();        
        User userTest = [SELECT ID,EMAIL,Name from User WHERE Name =:'Anita Li'];
        env.fromAddress = userTest.Email;
        email.fromAddress = userTest.Email;
        email.subject = '[#RVID:'+ calst[0].id +'#]Please review this opportunity';
        email.plainTextBody = ' reject \nTest002';
        testPriceApprove.handleInboundEmail( email , env );  		
        email.plainTextBody = ' yes \nTest001';
        testPriceApprove.handleInboundEmail( email , env );  
        //Opportunity testOpp = [SELECT ID, Price_Approval_Status__c From Opportunity Where ID=:testObj.Id];
        
    }
     public static testMethod void submitTest3(){
        Account a = new Account();
        a.VAT_NO__c = 'ABC';
        a.Name = 'Jinko SOlar Company';
        a.Phone = '13615827359';
        a.Website = 'www.jinko.com';
        Id RecordTypeId = Schema.SObjectType.Account.getRecordTypeInfosByDeveloperName().get('China_Account').getRecordTypeId();
        System.debug('RecordTypeId----------->'+RecordTypeId);
        a.RecordTypeId = RecordTypeId;
        a.Bank_Account__c = '中国银行';
        a.Bank_City__c = '上海';
        a.Bank_Code__c = '12345';
        a.Bank_Country__c = '中国';
        //a.Bank_Name__c = '虹口支行';
        a.Bank_Region__c = 'CN';
        a.Bank_Street__c = '上海市虹口区密云路2333号';    	
        a.BillingCity = '上海市';
        a.BillingCountry = '中国';
        a.BillingState = 'Test';
        a.BillingStreet = 'Test';
        Insert a;
        Contact cc = new Contact();         
        cc.Phone = '13615827359';
        cc.AccountId = a.id;
        cc.FirstName = 'Guang';
        cc.LastName = 'AWEJ';         
        insert cc;    	    
        leanx__pm_Project__c opp = new leanx__pm_Project__c();
        opp.Expect_Price_And_Comments__c = '12345';       
        opp.Name = '12345'; 
        opp.CurrencyIsoCode = 'CNY';
        opp.leanx__Account__c = a.id;
        opp.Trade_Term__c = 'CIF';                  
        opp.Destination_Country__c = 'China';
        opp.Destination_Region__c = 'CN';       
        opp.Delivery_Point__c = '手提';
        opp.Seller__c = 'ZHEJIANG JINKO SOLAR CO.,LTD';
        opp.Warranty_Insurance__c = 'AR';     
        opp.Commission__c = 0.1;
        opp.Commission_Type__c = 'Per/W';              
        Insert opp;
          
        ApexPages.currentPage().getParameters().put('id',opp.Id);  
        ApexPages.currentPage().getParameters().put('num','3');   
        ApexPages.currentPage().getParameters().put('conid','no');   
        RC_CommissionApplication op =new RC_CommissionApplication();
          Commission_Application2__c aaa = new Commission_Application2__c();
          aaa.Project__c =opp.id;
          aaa.Address_of_Payee__c='123';
          aaa.Name = 'OPPV1';
          aaa.Office_address_of_Buyer__c='123';
          aaa.Contact_person_of_Buyer__c='123';
          aaa.Position_of_contact_person_in_the_Buyer__c = '123';
          aaa.Shareholder_of_Buyer__c = '123';
          aaa.Contract_Unit_price__c = 1.4;
          aaa.Project_Location_Coutry__c ='13';
          aaa.Project_location_Address__c = '123';
          aaa.Role_of_Buyer_in_the_project__c = 'EPC';
          aaa.Nature_of_project__c = 'Utility';
          aaa.Commission_Per_watt__c = 0.01;
          aaa.Commission_Payee_Company__c = '123';
          aaa.Name_of_contact_person_of_Payee__c = '123';
          aaa.Position_of_contact_person_in_the_Payee__c='123';
          aaa.Mobile_Number_of_contact_person_of_Payee__c ='123';
          aaa.The_photocopy_of_ID_card__c = '21312412231231321';
          aaa.X7_1_TEXT__c = '123';
          aaa.X7_2_TEXT__c = '123';
          aaa.X7_3__c ='123';
          aaa.X7_4_TEXT__c = '132';
          aaa.Shareholder_of_Payee__c = '123';
          aaa.The_actual_controller_of_Payee__c = '123';
          aaa.The_photocopy_of_ID_card_of_shareholders__c = '123';
          aaa.The_photocopy_of_ID_card_of_actual_contr__c = '123';
          aaa.Number_of_employees_of_Payee__c = '123';
          aaa.X15_1_TEXT__c = '123';
          aaa.X15_2_TEXT__c = '123';
          aaa.X15_3_TEXT__c = '123';
          aaa.Role_of_the_Payee_in_the_Project__c = 'EPC';
          aaa.Work_done_by_the_Payee_for_Jinko__c = '123';
          aaa.X18_1_TEXT__c  = '123';
          aaa.X18_2_TEXT__c='123';
          aaa.X18_3_TEXT__c='123';
          aaa.X18_4_TEXT__c='123';
          aaa.X18_5_TEXT__c ='123';
          aaa.X18_6_TEXT__c = '123';
          aaa.X18_7_TEXT__c = '123';
          aaa.Brief_Record_of_the_Discussion__c= '123';          
          insert aaa;
          
       op.calst.add(aaa);
          op.caold =aaa;
          
          
          Commission_Application2__c aaa2 = new Commission_Application2__c();
          aaa2.Project__c =opp.id;
          aaa2.Address_of_Payee__c='123';
          aaa2.Name = 'OPPV1';
          aaa2.Office_address_of_Buyer__c='123';
          aaa2.Contact_person_of_Buyer__c='123';
          aaa2.Position_of_contact_person_in_the_Buyer__c = '123';
          aaa2.Shareholder_of_Buyer__c = '123';
          aaa2.Contract_Unit_price__c = 1.4;
          aaa2.Project_Location_Coutry__c ='13';
          aaa2.Project_location_Address__c = '123';
          aaa2.Role_of_Buyer_in_the_project__c = 'EPC';
          aaa2.Nature_of_project__c = 'Utility';
          aaa2.Commission_Per_watt__c = 0.01;
          aaa2.Commission_Payee_Company__c = '123';
          aaa2.Name_of_contact_person_of_Payee__c = '123';
          aaa2.Position_of_contact_person_in_the_Payee__c='123';
          aaa2.Mobile_Number_of_contact_person_of_Payee__c ='123';
          aaa2.The_photocopy_of_ID_card__c = '21312412231231321';
          aaa2.X7_1_TEXT__c = '123';
          aaa2.X7_2_TEXT__c = '123';
          aaa2.X7_3__c ='123';
          aaa2.X7_4_TEXT__c = '132';
          aaa2.Shareholder_of_Payee__c = '123';
          aaa2.The_actual_controller_of_Payee__c = '123';
          aaa2.The_photocopy_of_ID_card_of_shareholders__c = '123';
          aaa2.The_photocopy_of_ID_card_of_actual_contr__c = '123';
          aaa2.Number_of_employees_of_Payee__c = '123';
          aaa2.X15_1_TEXT__c = '123';
          aaa2.X15_2_TEXT__c = '123';
          aaa2.X15_3_TEXT__c = '123';
          aaa2.Role_of_the_Payee_in_the_Project__c = 'EPC';
          aaa2.Work_done_by_the_Payee_for_Jinko__c = '123';
          aaa2.X18_1_TEXT__c  = '123';
          aaa2.X18_2_TEXT__c='123';
          aaa2.X18_3_TEXT__c='123';
          aaa2.X18_4_TEXT__c='123';
          aaa2.X18_5_TEXT__c ='123';
          aaa2.X18_6_TEXT__c = '123';
          aaa2.X18_7_TEXT__c = '123';
          aaa2.Brief_Record_of_the_Discussion__c= '122';          
          insert aaa2;
          op.ca = aaa2;
        //第二个页面测试页面
        //CommissionApplicationVFCtrl cavf=new CommissionApplicationVFCtrl(std);
        op.blob1 =Blob.valueOf('this is Attachment body');
        op.blob1name ='this is Attachment body';
        op.blob14 =Blob.valueOf('this is Attachment body');
        op.blob14name ='this is Attachment body';
        op.blob15 =Blob.valueOf('this is Attachment body');
        op.blob15name ='this is Attachment body';
        op.blob16 =Blob.valueOf('this is Attachment body');
        op.blob16name ='this is Attachment body';
        op.blob17 =Blob.valueOf('this is Attachment body');
        op.blob17name ='this is Attachment body';
        op.blob23 =Blob.valueOf('this is Attachment body');
        op.blob23name ='this is Attachment body';
        op.blob24 =Blob.valueOf('this is Attachment body');
        op.blob24name ='this is Attachment body';
        op.blob25 =Blob.valueOf('this is Attachment body');
        op.blob25name ='this is Attachment body';
        op.blob26 =Blob.valueOf('this is Attachment body');
        op.blob26name ='this is Attachment body';
        op.blob27 =Blob.valueOf('this is Attachment body');
        op.blob27name ='this is Attachment body';
        op.blob29 =Blob.valueOf('this is Attachment body');
        op.blob29name ='this is Attachment body';
        op.blob211 =Blob.valueOf('this is Attachment body');
        op.blob211name ='this is Attachment body';
        op.blob213 =Blob.valueOf('this is Attachment body');
        op.blob213name ='this is Attachment body';
        op.blob212 =Blob.valueOf('this is Attachment body');
        op.blob212name ='this is Attachment body';
        op.blob215 =Blob.valueOf('this is Attachment body');
        op.blob215name ='this is Attachment body';
        op.blob219 =Blob.valueOf('this is Attachment body');
        op.blob219name ='this is Attachment body';        
        op.Addsobj();                
        //CommissionApplicationVFCtrl cavf1=new CommissionApplicationVFCtrl(std);
       /* cavf1.blob1 =Blob.valueOf('this is Attachment body');
        cavf1.blob1name ='this is Attachment body';
        cavf1.blob14 =Blob.valueOf('this is Attachment body');
        cavf1.blob14name ='this is Attachment body';
        cavf1.blob15 =Blob.valueOf('this is Attachment body');
        cavf1.blob15name ='this is Attachment body';
        cavf1.blob16 =Blob.valueOf('this is Attachment body');
        cavf1.blob16name ='this is Attachment body';
        cavf1.blob17 =Blob.valueOf('this is Attachment body');
        cavf1.blob17name ='this is Attachment body';
        cavf1.blob23 =Blob.valueOf('this is Attachment body');
        cavf1.blob23name ='this is Attachment body';
        cavf1.blob24 =Blob.valueOf('this is Attachment body');
        cavf1.blob24name ='this is Attachment body';
        cavf1.blob25 =Blob.valueOf('this is Attachment body');
        cavf1.blob25name ='this is Attachment body';
        cavf1.blob26 =Blob.valueOf('this is Attachment body');
        cavf1.blob26name ='this is Attachment body';
        cavf1.blob27 =Blob.valueOf('this is Attachment body');
        cavf1.blob27name ='this is Attachment body';
        cavf1.blob29 =Blob.valueOf('this is Attachment body');
        cavf1.blob29name ='this is Attachment body';
        cavf1.blob211 =Blob.valueOf('this is Attachment body');
        cavf1.blob211name ='this is Attachment body';
        cavf1.blob213 =Blob.valueOf('this is Attachment body');
        cavf1.blob213name ='this is Attachment body';
        cavf1.blob212 =Blob.valueOf('this is Attachment body');
        cavf1.blob212name ='this is Attachment body';
        cavf1.blob215 =Blob.valueOf('this is Attachment body');
        cavf1.blob215name ='this is Attachment body';
        cavf1.blob219 =Blob.valueOf('this is Attachment body');
        cavf1.blob219name ='this is Attachment body';        
        cavf1.Addsobj();
        test.stopTest();*/
        //对象内的页面
        String oppid=opp.Id;
        List<Commission_Application2__c> calst =Database.query(UtilClass.MakeSelectSql(Schema.SObjectType.Commission_Application2__c) + ' ' +
                                                               'Where Project__c =: oppid');
        User user = new User(Username='u'+System.now().getTime()+'@163.com',
                             Email='jason_trixpro@163.com',
                             FirstName='jason',
                             LastName='jia',
                             Alias='UJia',
                             ProfileId=UserInfo.getProfileId());               
        user.TimeZoneSidKey='Asia/Shanghai';
        user.LocaleSidKey='en_US';
        user.EmailEncodingKey='ISO-8859-1';
        user.LanguageLocaleKey='en_US';
        user.Region__c ='ROA';
        insert user;
        op.emailVoid();
         op.tts();
        op.sandboxemailtoCEO(aaa2.id);
        Opportunity testObj = TestHelper.createOpportunity(a.Id);       
        Messaging.InboundEmail email = new Messaging.InboundEmail();
        Messaging.InboundEnvelope env = new Messaging.InboundEnvelope();        
        RC_CommissionApproveEmailService testPriceApprove = new  RC_CommissionApproveEmailService();        
        User userTest = [SELECT ID,EMAIL,Name from User WHERE Name =:'Anita Li'];
        env.fromAddress = userTest.Email;
        email.fromAddress = userTest.Email;
        email.subject = '[#RVID:'+ calst[0].id +'#]Please review this opportunity';
        email.plainTextBody = ' reject \nTest002';
        testPriceApprove.handleInboundEmail( email , env );  		
        email.plainTextBody = ' yes \nTest001';
        testPriceApprove.handleInboundEmail( email , env );  
         op.aback();
        //Opportunity testOpp = [SELECT ID, Price_Approval_Status__c From Opportunity Where ID=:testObj.Id];
        
    }
}